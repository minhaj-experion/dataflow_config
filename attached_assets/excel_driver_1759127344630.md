
# Excel Ingestion Mapping Configuration

This document explains the structure and options available in the Excel ingestion YAML configuration.

---

## Top-Level Key: `mapping`
- **Description:** Root key for configuration mapping.
- **Mandatory:** Yes

---
### Input Configuration

#### `from` Section 

| Field | Description | Mandatory | Default Value |
|-------|-------------|-----------|---------------|
| `store.type` | Source type (e.g., `local`, `s3`) | Yes | None |
| `store.path` | Path to the input directory | Yes | None |
| `data_format.type` | Input data type (must be `excel`) | Yes | None |
| `data_format.skip_rows.footer_count` | Number of rows to skip from the bottom | No | `0` |
| `data_format.merge_sheets` | Whether to merge all sheets into one | No | `False` |
| `data_format.change_headers` | Custom headers to assign | No | None |
| `data_format.select_columns` | Columns to select | No | All columns |
| `data_format.index_col` | Column to use as index | No | None |
| `data_format.change_data_types` | Cast columns to new data types | No | None |
| `data_format.top_n_rows` | Read only top N rows | No | All rows |
| `data_format.null_values` | Values to treat as null | No | `["", "null", "None"]` |
| `data_format.keep_default_null` | Whether to keep pandas' default NA values | No | `True` |
| `data_format.na_filter` | Detect missing values | No | `True` |
| `data_format.parse_dates` | Automatically parse dates | No | `False` |

##### `entity` Subsection

| Field | Description | Mandatory | Default Value |
|-------|-------------|-----------|---------------|
| `include` | Files to include | Yes | None |
| `sheets.include` | Sheets to include (use `*all` for all) | Yes | None |

---
### Output Configuration

#### `to` Section

| Field | Description | Mandatory | Default Value |
|-------|-------------|-----------|---------------|
| `store.type` | Output type (e.g., `local`) | Yes | None |
| `store.path` | Output directory | Yes | None |
| `data_format.type` | Output file type (e.g., `excel`) | Yes | None |

##### `entities` Subsection

Each `entity` block defines rules for saving transformed output.

| Field | Description | Mandatory | Default Value |
|-------|-------------|-----------|---------------|
| `include` | Entity filter (e.g., filenames or patterns) | Yes | None |
| `file_name` | Output file name | Yes | None |
| `sheet_name` | Output sheet name (can be templated) | Yes | None |

---
